<!DOCTYPE html><html lang="en"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Data Explorer</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body {
            background-color: #0e0e0e;
            color: #f0f0f0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 2rem;
        }h1 {
        color: #ccc;
        text-align: center;
    }

    .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 1rem;
        justify-content: center;
        margin-bottom: 2rem;
    }

    .controls input,
    .controls select,
    .controls button {
        background: #1e1e1e;
        color: #f0f0f0;
        border: 1px solid #444;
        padding: 0.5rem 1rem;
        border-radius: 5px;
    }

    table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 2rem;
    }

    th,
    td {
        padding: 0.5rem;
        border: 1px solid #444;
        text-align: left;
    }

    th {
        background-color: #2c2c2c;
    }

    .chart-container {
        margin-top: 3rem;
    }

    #map {
        width: 100%;
        height: 500px;
    }
</style>

</head><body>
    <h1>World Data Explorer</h1><div class="controls">
    <input type="text" id="search" placeholder="Search country/capital...">
    <input type="number" id="minPop" placeholder="Min population">
    <input type="number" id="maxPop" placeholder="Max population">
    <select id="sort">
        <option value="">Sort By</option>
        <option value="name">Name A-Z</option>
        <option value="name-desc">Name Z-A</option>
        <option value="population">Population Low-High</option>
        <option value="population-desc">Population High-Low</option>
    </select>
    <button onclick="exportData()">Export CSV</button>
</div>

<table id="dataTable">
    <thead>
        <tr>
            <th>Country</th>
            <th>Capital</th>
            <th>Population</th>
        </tr>
    </thead>
    <tbody></tbody>
</table>

<div class="chart-container">
    <canvas id="populationChart"></canvas>
</div>

<div id="map"></div>

<script>
    const data = [
        { country: 'India', capital: 'New Delhi', population: 1393409038, lat: 28.6139, lon: 77.2090 },
        { country: 'USA', capital: 'Washington, D.C.', population: 331002651, lat: 38.9072, lon: -77.0369 },
        { country: 'Brazil', capital: 'BrasÃ­lia', population: 212559417, lat: -15.8267, lon: -47.9218 },
        { country: 'Russia', capital: 'Moscow', population: 145912025, lat: 55.7558, lon: 37.6173 },
        { country: 'Japan', capital: 'Tokyo', population: 126476461, lat: 35.6762, lon: 139.6503 }
    ];

    function renderTable(filtered = data) {
        const tbody = document.querySelector("#dataTable tbody");
        tbody.innerHTML = "";
        filtered.forEach(row => {
            const tr = document.createElement("tr");
            tr.innerHTML = `<td>${row.country}</td><td>${row.capital}</td><td>${row.population.toLocaleString()}</td>`;
            tbody.appendChild(tr);
        });
        renderChart(filtered);
        renderMap(filtered);
    }

    function filterData() {
        const search = document.getElementById('search').value.toLowerCase();
        const minPop = parseInt(document.getElementById('minPop').value) || 0;
        const maxPop = parseInt(document.getElementById('maxPop').value) || Infinity;
        const sort = document.getElementById('sort').value;

        let filtered = data.filter(d =>
            (d.country.toLowerCase().includes(search) || d.capital.toLowerCase().includes(search)) &&
            d.population >= minPop &&
            d.population <= maxPop
        );

        if (sort === 'name') filtered.sort((a, b) => a.country.localeCompare(b.country));
        if (sort === 'name-desc') filtered.sort((a, b) => b.country.localeCompare(a.country));
        if (sort === 'population') filtered.sort((a, b) => a.population - b.population);
        if (sort === 'population-desc') filtered.sort((a, b) => b.population - a.population);

        renderTable(filtered);
    }

    function renderChart(dataSet) {
        const ctx = document.getElementById('populationChart').getContext('2d');
        if (window.popChart) window.popChart.destroy();
        window.popChart = new Chart(ctx, {
            type: 'bar',
            data: {
                labels: dataSet.map(d => d.country),
                datasets: [{
                    label: 'Population',
                    data: dataSet.map(d => d.population),
                    backgroundColor: '#999',
                    borderColor: '#f0f0f0',
                    borderWidth: 1
                }]
            },
            options: {
                scales: {
                    y: {
                        ticks: {
                            color: '#ccc'
                        },
                        beginAtZero: true
                    },
                    x: {
                        ticks: {
                            color: '#ccc'
                        }
                    }
                }
            }
        });
    }

    function renderMap(dataSet) {
        const mapData = [{
            type: 'scattergeo',
            mode: 'markers',
            text: dataSet.map(d => `${d.country}<br>${d.capital}<br>Pop: ${d.population.toLocaleString()}`),
            lon: dataSet.map(d => d.lon),
            lat: dataSet.map(d => d.lat),
            marker: {
                size: dataSet.map(d => Math.sqrt(d.population) / 1000),
                color: '#ccc'
            }
        }];

        const layout = {
            geo: {
                bgcolor: '#0e0e0e',
                showland: true,
                landcolor: '#1e1e1e'
            },
            paper_bgcolor: '#0e0e0e',
            plot_bgcolor: '#0e0e0e'
        };

        Plotly.newPlot('map', mapData, layout, { responsive: true });
    }

    function exportData() {
        const headers = ['Country', 'Capital', 'Population'];
        const rows = data.map(d => [d.country, d.capital, d.population]);
        const csv = [headers.join(','), ...rows.map(r => r.join(','))].join('\n');
        const blob = new Blob([csv], { type: 'text/csv' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'world_data.csv';
        a.click();
    }

    document.querySelectorAll("#search, #minPop, #maxPop, #sort").forEach(el => el.addEventListener("input", filterData));

    renderTable();
</script>

</body></html>
